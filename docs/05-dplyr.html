<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Manipulación de datos ordenados usando {dplyr} - Primera parte</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/united.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<script src="site_libs/accessible-code-block-0.0.1/empty-anchor.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
      code.sourceCode > span { display: inline-block; line-height: 1.25; }
  code.sourceCode > span { color: inherit; text-decoration: inherit; }
  code.sourceCode > span:empty { height: 1.2em; }
  .sourceCode { overflow: visible; }
  code.sourceCode { white-space: pre; position: relative; }
  div.sourceCode { margin: 1em 0; }
  pre.sourceCode { margin: 0; }
  @media screen {
  div.sourceCode { overflow: auto; }
  }
  @media print {
  code.sourceCode { white-space: pre-wrap; }
  code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
  }
  pre.numberSource code
    { counter-reset: source-line 0; }
  pre.numberSource code > span
    { position: relative; left: -4em; counter-increment: source-line; }
  pre.numberSource code > span > a:first-child::before
    { content: counter(source-line);
      position: relative; left: -1em; text-align: right; vertical-align: baseline;
      border: none; display: inline-block;
      -webkit-touch-callout: none; -webkit-user-select: none;
      -khtml-user-select: none; -moz-user-select: none;
      -ms-user-select: none; user-select: none;
      padding: 0 4px; width: 4em;
      color: #aaaaaa;
    }
  pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
  div.sourceCode
    {  background-color: #f8f8f8; }
  @media screen {
  code.sourceCode > span > a:first-child::before { text-decoration: underline; }
  }
  code span.al { color: #ef2929; } /* Alert */
  code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
  code span.at { color: #c4a000; } /* Attribute */
  code span.bn { color: #0000cf; } /* BaseN */
  code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
  code span.ch { color: #4e9a06; } /* Char */
  code span.cn { color: #000000; } /* Constant */
  code span.co { color: #8f5902; font-style: italic; } /* Comment */
  code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
  code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
  code span.dt { color: #204a87; } /* DataType */
  code span.dv { color: #0000cf; } /* DecVal */
  code span.er { color: #a40000; font-weight: bold; } /* Error */
  code span.ex { } /* Extension */
  code span.fl { color: #0000cf; } /* Float */
  code span.fu { color: #000000; } /* Function */
  code span.im { } /* Import */
  code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
  code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
  code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
  code span.ot { color: #8f5902; } /* Other */
  code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
  code span.sc { color: #000000; } /* SpecialChar */
  code span.ss { color: #4e9a06; } /* SpecialString */
  code span.st { color: #4e9a06; } /* String */
  code span.va { color: #000000; } /* Variable */
  code span.vs { color: #4e9a06; } /* VerbatimString */
  code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
    </style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
#rmd-source-code {
  display: none;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">R para Clima</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="hoja-de-ruta.html">Hoja de ruta</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Temas
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="01-introduccion.html">Introducción</a>
    </li>
    <li>
      <a href="02-proyectos.html">Proyectos de RStudio</a>
    </li>
    <li>
      <a href="03-reportes-I.html">Reportes I</a>
    </li>
    <li>
      <a href="04-lectura.html">Lectura de datos</a>
    </li>
    <li>
      <a href="05-dplyr.html">Manipulación de datos I</a>
    </li>
    <li>
      <a href="06-dplyr-tidyr-II.html">Manipulación de datos II</a>
    </li>
    <li>
      <a href="07-graficos-I.html">Gráficos I</a>
    </li>
    <li>
      <a href="08-lubridate.html">Manipulación fechas</a>
    </li>
    <li>
      <a href="09-graficos-II.html">Gráficos II</a>
    </li>
    <li>
      <a href="10-graficos-III.html">Gráficos para publicar</a>
    </li>
    <li>
      <a href="11-reportes-II.html">Reportes II</a>
    </li>
    <li>
      <a href="12-publicar.html">Publicar reportes</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Desafíos
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="desafio-1.html">Leer y analizar datos</a>
    </li>
    <li>
      <a href="desafio-2.html">Graficar datos</a>
    </li>
    <li>
      <a href="desafio-3.html">Generar un informe</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Manipulación de datos ordenados usando {dplyr} - Primera parte</h1>

</div>


<p>El paquete {dplyr} provee una enorme cantidad de funciones útiles para manipular y analizar datos de manera intuitiva y expresiva.</p>
<p>El espíritu detrás de {dplyr} es que la enorme mayoría de los análisis, por más complicados que sean, involucran combinar y encadenar una serie relativamente acotada de acciones (o verbos). Vamos a comenzar a trabajar con las cinco más comunes:</p>
<ul>
<li><code>select()</code>: selecciona columnas de una tabla.</li>
<li><code>filter()</code>: selecciona (o filtra) filas de una tabla a partir de una o más condiciones lógicas.</li>
<li><code>group_by()</code>: agrupa una tabla en base al valor de una o más columnas.</li>
<li><code>mutate()</code>: agrega nuevas columnas a una tabla.</li>
<li><code>summarise()</code>: calcula estadísticas para cada grupo de una tabla.</li>
</ul>
<div class="alert alert-info">
<p><strong>Primer desafío:</strong></p>
<p>Te dieron una tabla con datos de temperatura mínima y máxima para distintas estaciones meteorológicas de todo el país durante los 365 días de un año. Las columnas son: <code>id_estacion</code>, <code>temperatura_maxima</code>, <code>temperatura_minima</code> y <code>provincia</code>. En base a esos datos, te piden que computen la temperatura media anual de cada estación únicamente de las estaciones de La Pampa.</p>
<p>¿En qué orden ejecutarías estos pasos para obtener el resultado deseado? Todavía sin correr ninguna línea de código.</p>
<ul>
<li>usar <code>summarise()</code> para calcular la estadística <code>mean(temperatura_media)</code> para cada <code>id_estacion</code></li>
<li>usar <code>group_by()</code> para agrupar por la columna <code>id_estacion</code></li>
<li>usar <code>mutate()</code> para agregar una columna llamada <code>temperatura_media</code> que sea <code>(temperatura_minima + temperatura_maxima)/2</code>.</li>
<li>usar <code>filter()</code> para seleccionar solo las filas donde la columnas <code>provincia</code> es igual a “La Pampa”</li>
</ul>
</div>
<p>Para usar {dplyr} primero hay que instalarlo con el comando:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">install.packages</span>(<span class="st">&#39;dplyr&#39;</span>)</span></code></pre></div>
<p>o junto con todos los paquetes del universo de Tidyverse y luego cargarlo en memoria con</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw">library</span>(dplyr)</span></code></pre></div>
<p>Cargar los datos de la estación de Bariloche (para un recordatorio, podés ir a <a href="04-lectura-datos.html">Lectura de datos ordenados</a>):</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="kw">library</span>(readr)</span>
<span id="cb3-2"><a href="#cb3-2"></a>bariloche &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;datos/bariloche_enlimpio.csv&quot;</span>)</span></code></pre></div>
<pre><code>## Parsed with column specification:
## cols(
##   .default = col_logical(),
##   Fecha = col_datetime(format = &quot;&quot;),
##   Temperatura_Abrigo_150cm = col_double(),
##   Temperatura_Abrigo_150cm_Maxima = col_double(),
##   Temperatura_Abrigo_150cm_Minima = col_double(),
##   Temperatura_Suelo_10cm_Media = col_double(),
##   Precipitacion_Pluviometrica = col_double(),
##   Precipitacion_Cronologica = col_double(),
##   Precipitacion_Maxima_30minutos = col_double(),
##   Tesion_Vapor_Media = col_double(),
##   Humedad_Media = col_double(),
##   Humedad_Media_8_14_20 = col_double(),
##   Rocio_Medio = col_double(),
##   Direccion_Viento_200cm = col_character(),
##   Direccion_Viento_1000cm = col_character(),
##   Horas_Frio = col_double(),
##   Unidades_Frio = col_double(),
##   mes = col_character()
## )</code></pre>
<pre><code>## See spec(...) for full column specifications.</code></pre>
<div id="seleccionando-columnas-con-select" class="section level2">
<h2>Seleccionando columnas con <code>select()</code></h2>
<p>Para quedarse únicamente con las columnas de Fecha, Temperatura_Abrigo_150cm y Humedad_Media podés usar <code>select()</code>, el primer argumento es siempre el data.frame:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="kw">select</span>(bariloche, Fecha, Temperatura_Abrigo_150cm, Humedad_Media) <span class="co"># Ojo con las mayúsculas!</span></span></code></pre></div>
<pre><code>## # A tibble: 3,024 x 3
##    Fecha               Temperatura_Abrigo_150cm Humedad_Media
##    &lt;dttm&gt;                                 &lt;dbl&gt;         &lt;dbl&gt;
##  1 2011-05-28 00:00:00                    NA               NA
##  2 2011-05-29 00:00:00                     4.27            79
##  3 2011-05-30 00:00:00                     1.69            93
##  4 2011-05-31 00:00:00                     3.47            96
##  5 2011-06-01 00:00:00                     2.90            98
##  6 2011-06-02 00:00:00                     6.26            93
##  7 2011-06-03 00:00:00                     3.45            88
##  8 2011-06-04 00:00:00                     6.09            87
##  9 2011-06-05 00:00:00                     5.00           100
## 10 2011-06-06 00:00:00                     5.45            91
## # … with 3,014 more rows</code></pre>
<p>¿Dónde quedó este resultado? Si te fijás en la variable <code>bariloche</code>, ésta está intacta:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>bariloche</span></code></pre></div>
<pre><code>## # A tibble: 3,024 x 31
##    Fecha               Temperatura_Abr… Temperatura_Abr… Temperatura_Abr…
##    &lt;dttm&gt;                         &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;
##  1 2011-05-28 00:00:00            NA                NA               NA  
##  2 2011-05-29 00:00:00             4.27             12.8             -1.2
##  3 2011-05-30 00:00:00             1.69              9.2             -2.8
##  4 2011-05-31 00:00:00             3.47              9.6              0.5
##  5 2011-06-01 00:00:00             2.90              9.6             -1.5
##  6 2011-06-02 00:00:00             6.26             13.3              2.9
##  7 2011-06-03 00:00:00             3.45             12.6             -1.8
##  8 2011-06-04 00:00:00             6.09             10.2              3.9
##  9 2011-06-05 00:00:00             5.00              7.1              3.4
## 10 2011-06-06 00:00:00             5.45              9.5              3.2
## # … with 3,014 more rows, and 27 more variables:
## #   Temperatura_Intemperie_5cm_Minima &lt;lgl&gt;,
## #   Temperatura_Intemperie_50cm_Minima &lt;lgl&gt;,
## #   Temperatura_Suelo_5cm_Media &lt;lgl&gt;, Temperatura_Suelo_10cm_Media &lt;dbl&gt;,
## #   Temperatura_Inte_5cm &lt;lgl&gt;, Temperatura_Intemperie_150cm_Minima &lt;lgl&gt;,
## #   Humedad_Suelo &lt;lgl&gt;, Precipitacion_Pluviometrica &lt;dbl&gt;,
## #   Precipitacion_Cronologica &lt;dbl&gt;, Precipitacion_Maxima_30minutos &lt;dbl&gt;,
## #   Heliofania_Efectiva &lt;lgl&gt;, Heliofania_Relativa &lt;lgl&gt;,
## #   Tesion_Vapor_Media &lt;dbl&gt;, Humedad_Media &lt;dbl&gt;, Humedad_Media_8_14_20 &lt;dbl&gt;,
## #   Rocio_Medio &lt;dbl&gt;, Duracion_Follaje_Mojado &lt;lgl&gt;,
## #   Velocidad_Viento_200cm_Media &lt;lgl&gt;, Direccion_Viento_200cm &lt;chr&gt;,
## #   Velocidad_Viento_1000cm_Media &lt;lgl&gt;, Direccion_Viento_1000cm &lt;chr&gt;,
## #   Velocidad_Viento_Maxima &lt;lgl&gt;, Presion_Media &lt;lgl&gt;, Radiacion_Global &lt;lgl&gt;,
## #   Horas_Frio &lt;dbl&gt;, Unidades_Frio &lt;dbl&gt;, mes &lt;chr&gt;</code></pre>
<p><code>select()</code> y el resto de las funciones de {dplyr} siempre generan una nueva tabla y nunca modifican la tabla original. Para guardar la tabla con las tres columnas <code>Fecha</code>, <code>Temperatura_Abrigo_150cm</code> y <code>Humedad_Media</code> tenés que asignar el resultado a una nueva variable.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>temp_hum &lt;-<span class="st"> </span><span class="kw">select</span>(bariloche, Fecha, Temperatura_Abrigo_150cm, Humedad_Media)</span>
<span id="cb10-2"><a href="#cb10-2"></a>temp_hum</span></code></pre></div>
<pre><code>## # A tibble: 3,024 x 3
##    Fecha               Temperatura_Abrigo_150cm Humedad_Media
##    &lt;dttm&gt;                                 &lt;dbl&gt;         &lt;dbl&gt;
##  1 2011-05-28 00:00:00                    NA               NA
##  2 2011-05-29 00:00:00                     4.27            79
##  3 2011-05-30 00:00:00                     1.69            93
##  4 2011-05-31 00:00:00                     3.47            96
##  5 2011-06-01 00:00:00                     2.90            98
##  6 2011-06-02 00:00:00                     6.26            93
##  7 2011-06-03 00:00:00                     3.45            88
##  8 2011-06-04 00:00:00                     6.09            87
##  9 2011-06-05 00:00:00                     5.00           100
## 10 2011-06-06 00:00:00                     5.45            91
## # … with 3,014 more rows</code></pre>
<div class="figure">
<img src="img/dplyr-select.png" alt="" />
<p class="caption">Cómo funciona <code>select()</code></p>
</div>
</div>
<div id="filtrando-filas-con-filter" class="section level2">
<h2>Filtrando filas con <code>filter()</code></h2>
<p>Ahora podés usar <code>filter()</code> para quedarte con sólo unas filas. Por ejemplo, para ver aquellos días con temperatura menor a 0 grados:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="kw">filter</span>(temp_hum, Temperatura_Abrigo_150cm <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>)</span></code></pre></div>
<pre><code>## # A tibble: 38 x 3
##    Fecha               Temperatura_Abrigo_150cm Humedad_Media
##    &lt;dttm&gt;                                 &lt;dbl&gt;         &lt;dbl&gt;
##  1 2011-06-25 00:00:00                   -1.91             86
##  2 2011-07-02 00:00:00                   -0.865            79
##  3 2011-07-03 00:00:00                   -1.77             80
##  4 2011-07-04 00:00:00                   -1.18             82
##  5 2011-07-05 00:00:00                   -1.58             90
##  6 2011-07-17 00:00:00                   -0.647            86
##  7 2011-07-18 00:00:00                   -0.126            86
##  8 2011-07-31 00:00:00                   -0.756            89
##  9 2012-06-06 00:00:00                   -1.92             83
## 10 2012-06-07 00:00:00                   -0.915            85
## # … with 28 more rows</code></pre>
<p>La mayoría de los análisis consisten en varios pasos (en el primer desafío usaste 4 pasos para calcular las temperaturas medias de una serie de estaciones). La única tabla que te interesa es la última, por lo que ir asignando variables nuevas en cada paso intermedio es tedioso y poco práctico. Para eso se usa el operador ‘pipe’ (<code>%&gt;%</code>).</p>
<p>El operador ‘pipe’ (<code>%&gt;%</code>) agarra el resultado de una función y se lo pasa a la siguiente. Esto permite escribir el código como una cadena de funciones que van operando sobre el resultado de la anterior.</p>
<p>Las dos operaciones anteriores (seleccionar tres columnas y luego filtar las filas correspondientes temperaturas menores a 0°C) se pueden escribir uno después del otro y sin asignar los resultados intermedios a nuevas variables de esta forma:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>bariloche <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="st">  </span><span class="kw">select</span>(Fecha, Temperatura_Abrigo_150cm, Humedad_Media) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb14-3"><a href="#cb14-3"></a><span class="st">  </span><span class="kw">filter</span>(Temperatura_Abrigo_150cm <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>)</span></code></pre></div>
<pre><code>## # A tibble: 38 x 3
##    Fecha               Temperatura_Abrigo_150cm Humedad_Media
##    &lt;dttm&gt;                                 &lt;dbl&gt;         &lt;dbl&gt;
##  1 2011-06-25 00:00:00                   -1.91             86
##  2 2011-07-02 00:00:00                   -0.865            79
##  3 2011-07-03 00:00:00                   -1.77             80
##  4 2011-07-04 00:00:00                   -1.18             82
##  5 2011-07-05 00:00:00                   -1.58             90
##  6 2011-07-17 00:00:00                   -0.647            86
##  7 2011-07-18 00:00:00                   -0.126            86
##  8 2011-07-31 00:00:00                   -0.756            89
##  9 2012-06-06 00:00:00                   -1.92             83
## 10 2012-06-07 00:00:00                   -0.915            85
## # … with 28 more rows</code></pre>
<p>La forma de “leer” esto es “Tomá la variable <code>bariloche</code>, <strong>después</strong> aplicale <code>select(Fecha, Temperatura_Abrigo_150cm, Humedad_Media)</code>, <strong>después</strong> aplicale <code>filter(Temperatura_Abrigo_150cm &lt; 0)</code>”.</p>
<p>Cómo vimos, el primero argumento de todas las funciones de dplyr espera un data.frame y justamente el operador <code>%&gt;%</code> toma el data.frame <code>bariloche</code> y se lo pasa al primer argumento de <code>select()</code>. Luego el data.frame resultante de seleccionar las columnas Fecha, Temperatura_Abrigo_150cm y Humedad_Media <em>pasa</em> como el primer argumento de la función <code>filter()</code> gracias al <code>%&gt;%</code>.</p>
<div class="alert alert-success">
<p><strong>Tip:</strong></p>
<p>En RStudio podés escribir <code>%&gt;%</code> usando el atajo de teclado Ctr + Shift + M. ¡Probalo!</p>
</div>
<div class="alert alert-info">
<p><strong>Desafío:</strong></p>
<p>Completá esta cadena para producir una tabla que contenga los valores de Fecha, Temperatura del suelo y la Humedad únicamente cuando la Humedad es igual a 100%.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>bariloche <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb16-2"><a href="#cb16-2"></a><span class="st">  </span><span class="kw">filter</span>(Humedad_Media <span class="op">==</span><span class="st"> </span>___) <span class="op">%&gt;%</span></span>
<span id="cb16-3"><a href="#cb16-3"></a><span class="st">  </span><span class="kw">select</span>(___, ___, ___)</span></code></pre></div>
</div>
</div>
<div id="agrupando-y-reduciendo-con-group_by-summarise" class="section level2">
<h2>Agrupando y reduciendo con <code>group_by() %&gt;% summarise()</code></h2>
<p>Si querés calcular la temperatura media para cada mes, tenés que usar el combo <code>group_by() %&gt;% summarise()</code>. Es decir, primero agrupar la tabla según la columna <code>mes</code> y luego calcular un promedio de <code>Temperatura_Abrigo_150cm</code> para cada grupo.</p>
<p>Para agrupar la tabla <code>bariloche</code> según el mes usamos el siguiente código:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>bariloche <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="st">  </span><span class="kw">group_by</span>(mes) </span></code></pre></div>
<pre><code>## # A tibble: 3,024 x 31
## # Groups:   mes [12]
##    Fecha               Temperatura_Abr… Temperatura_Abr… Temperatura_Abr…
##    &lt;dttm&gt;                         &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;
##  1 2011-05-28 00:00:00            NA                NA               NA  
##  2 2011-05-29 00:00:00             4.27             12.8             -1.2
##  3 2011-05-30 00:00:00             1.69              9.2             -2.8
##  4 2011-05-31 00:00:00             3.47              9.6              0.5
##  5 2011-06-01 00:00:00             2.90              9.6             -1.5
##  6 2011-06-02 00:00:00             6.26             13.3              2.9
##  7 2011-06-03 00:00:00             3.45             12.6             -1.8
##  8 2011-06-04 00:00:00             6.09             10.2              3.9
##  9 2011-06-05 00:00:00             5.00              7.1              3.4
## 10 2011-06-06 00:00:00             5.45              9.5              3.2
## # … with 3,014 more rows, and 27 more variables:
## #   Temperatura_Intemperie_5cm_Minima &lt;lgl&gt;,
## #   Temperatura_Intemperie_50cm_Minima &lt;lgl&gt;,
## #   Temperatura_Suelo_5cm_Media &lt;lgl&gt;, Temperatura_Suelo_10cm_Media &lt;dbl&gt;,
## #   Temperatura_Inte_5cm &lt;lgl&gt;, Temperatura_Intemperie_150cm_Minima &lt;lgl&gt;,
## #   Humedad_Suelo &lt;lgl&gt;, Precipitacion_Pluviometrica &lt;dbl&gt;,
## #   Precipitacion_Cronologica &lt;dbl&gt;, Precipitacion_Maxima_30minutos &lt;dbl&gt;,
## #   Heliofania_Efectiva &lt;lgl&gt;, Heliofania_Relativa &lt;lgl&gt;,
## #   Tesion_Vapor_Media &lt;dbl&gt;, Humedad_Media &lt;dbl&gt;, Humedad_Media_8_14_20 &lt;dbl&gt;,
## #   Rocio_Medio &lt;dbl&gt;, Duracion_Follaje_Mojado &lt;lgl&gt;,
## #   Velocidad_Viento_200cm_Media &lt;lgl&gt;, Direccion_Viento_200cm &lt;chr&gt;,
## #   Velocidad_Viento_1000cm_Media &lt;lgl&gt;, Direccion_Viento_1000cm &lt;chr&gt;,
## #   Velocidad_Viento_Maxima &lt;lgl&gt;, Presion_Media &lt;lgl&gt;, Radiacion_Global &lt;lgl&gt;,
## #   Horas_Frio &lt;dbl&gt;, Unidades_Frio &lt;dbl&gt;, mes &lt;chr&gt;</code></pre>
<p>A primera vista parecería que la función no hizo nada, pero fijate que el resultado ahora dice que tiene grupos (“Groups:”), y nos dice qué columna es la que agrupa los datos (“mes”) y cuántos grupos hay (“12”). Las operaciones subsiguientes que le hagamos a esta tabla van a hacerse <em>para cada grupo</em>.</p>
<p>Para ver esto en acción, usá <code>summarise()</code> para computar el promedio de la temperatura:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>bariloche <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb19-2"><a href="#cb19-2"></a><span class="st">  </span><span class="kw">group_by</span>(mes) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb19-3"><a href="#cb19-3"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">Temperatura_media =</span> <span class="kw">mean</span>(Temperatura_Abrigo_150cm))</span></code></pre></div>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<pre><code>## # A tibble: 12 x 2
##    mes        Temperatura_media
##    &lt;chr&gt;                  &lt;dbl&gt;
##  1 abril                   NA  
##  2 agosto                  NA  
##  3 diciembre               14.0
##  4 enero                   NA  
##  5 febrero                 NA  
##  6 julio                   NA  
##  7 junio                   NA  
##  8 marzo                   NA  
##  9 mayo                    NA  
## 10 noviembre               NA  
## 11 octubre                 NA  
## 12 septiembre              NA</code></pre>
<p>¡Tadá! <code>summarise()</code> devuelve una tabla con una columna para el continente y otra nueva, llamada “Temperatura_media” que contiene el promedio de <code>Temperatura_Abrigo_150cm</code> para cada grupo. Pero… aparecen muchos datos faltantes, cuando en realidad hay muchas observaciones para cada mes.</p>
<p>Si revisamos la ayuda de la función <code>mean()</code>, vemos que tiene un argumento que por defecto es <code>na.rm = FALSE</code>, esto significa que si al menos una observación es <code>NA</code>, el resultado será <code>NA</code>. Cambiemos este argumento a <code>TRUE</code> para cambiar el comportamiento de la función.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a>bariloche <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb22-2"><a href="#cb22-2"></a><span class="st">  </span><span class="kw">group_by</span>(mes) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb22-3"><a href="#cb22-3"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">Temperatura_media =</span> <span class="kw">mean</span>(Temperatura_Abrigo_150cm, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</span></code></pre></div>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<pre><code>## # A tibble: 12 x 2
##    mes        Temperatura_media
##    &lt;chr&gt;                  &lt;dbl&gt;
##  1 abril                  10.5 
##  2 agosto                  4.83
##  3 diciembre              14.0 
##  4 enero                  16.6 
##  5 febrero                16.0 
##  6 julio                   3.69
##  7 junio                   5.18
##  8 marzo                  13.8 
##  9 mayo                    7.34
## 10 noviembre              11.6 
## 11 octubre                 8.59
## 12 septiembre              6.43</code></pre>
<p>Ahora si, tenemos la temperatura media para cada mes. <code>group_by()</code> permite agrupar en base a múltiples columnas y <code>summarise()</code> permite generar múltiples columnas de resumen. El resultado va a siempre ser una tabla con la misma cantidad de filas que grupos y una cantidad de columnas igual a la cantidad de columnas usadas para agrupar y los estadísticos computados.</p>
<div class="alert alert-info">
<p><strong>Desafío:</strong></p>
<p>¿Cuál te imaginás que va a ser el resultado del siguiente código? ¿Cuántas filas y columnas va a tener? (Tratá de pensarlo antes de correrlo.)</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a>bariloche <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb25-2"><a href="#cb25-2"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">Temperatura_media =</span> <span class="kw">mean</span>(Temperatura_Abrigo_150cm))</span></code></pre></div>
</div>
<p>El combo <code>group_by() %&gt;% summarise()</code> se puede resumir en esta figura. Las filas de una tabla se dividen en grupos, y luego cada grupo se “resume” en una fila en función del estadístico usado.</p>
<p><img src="img/group_by-summarize.png" /></p>
<p>Al igual que hicimos “cuentas” usando algunas variables numéricas para obtener información nueva, también podemos utilizar variables categóricas. No tiene sentido calcular <code>mean(mes)</code> ya que contienen caracteres, pero tal vez nos interese <em>contar</em> la cantidad de observaciones por mes:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a>bariloche <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb26-2"><a href="#cb26-2"></a><span class="st">  </span><span class="kw">group_by</span>(mes) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb26-3"><a href="#cb26-3"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">cantidad =</span> <span class="kw">n</span>())</span></code></pre></div>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<pre><code>## # A tibble: 12 x 2
##    mes        cantidad
##    &lt;chr&gt;         &lt;int&gt;
##  1 abril           239
##  2 agosto          276
##  3 diciembre       248
##  4 enero           248
##  5 febrero         227
##  6 julio           273
##  7 junio           254
##  8 marzo           248
##  9 mayo            239
## 10 noviembre       241
## 11 octubre         279
## 12 septiembre      252</code></pre>
<div class="alert alert-success">
<p>En R se puede resolver un problema de muchas maneras, por ejemplo, el código anterior y el que sigue dan resultados equivalentes:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a>bariloche <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb29-2"><a href="#cb29-2"></a><span class="st">  </span><span class="kw">group_by</span>(mes) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb29-3"><a href="#cb29-3"></a><span class="st">  </span><span class="kw">count</span>()</span></code></pre></div>
<pre><code>## # A tibble: 12 x 2
## # Groups:   mes [12]
##    mes            n
##    &lt;chr&gt;      &lt;int&gt;
##  1 abril        239
##  2 agosto       276
##  3 diciembre    248
##  4 enero        248
##  5 febrero      227
##  6 julio        273
##  7 junio        254
##  8 marzo        248
##  9 mayo         239
## 10 noviembre    241
## 11 octubre      279
## 12 septiembre   252</code></pre>
<p>En este caso <code>count()</code> es análogo a <code>summarise(cantidad = n())</code>.</p>
</div>
</div>
<div id="creando-nuevas-columnas-con-mutate" class="section level2">
<h2>Creando nuevas columnas con <code>mutate()</code></h2>
<p>Todo esto está bien para hacer cálculos con columnas previamente existentes, pero muchas veces tenés que crear nuevas columnas.</p>
<p>La tabla <code>bariloche</code> tiene información de temperaturas en grados centígrados y puede ser necesario convertirlas a kelvin. <code>mutate()</code> permite agregar una nueva columna llamada “Temperatura_kelvin” con esa información:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a>bariloche <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb31-2"><a href="#cb31-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Temperatura_kelvin =</span> Temperatura_Abrigo_150cm <span class="op">+</span><span class="st"> </span><span class="dv">273</span>,<span class="dv">15</span>)</span></code></pre></div>
<pre><code>## # A tibble: 3,024 x 33
##    Fecha               Temperatura_Abr… Temperatura_Abr… Temperatura_Abr…
##    &lt;dttm&gt;                         &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;
##  1 2011-05-28 00:00:00            NA                NA               NA  
##  2 2011-05-29 00:00:00             4.27             12.8             -1.2
##  3 2011-05-30 00:00:00             1.69              9.2             -2.8
##  4 2011-05-31 00:00:00             3.47              9.6              0.5
##  5 2011-06-01 00:00:00             2.90              9.6             -1.5
##  6 2011-06-02 00:00:00             6.26             13.3              2.9
##  7 2011-06-03 00:00:00             3.45             12.6             -1.8
##  8 2011-06-04 00:00:00             6.09             10.2              3.9
##  9 2011-06-05 00:00:00             5.00              7.1              3.4
## 10 2011-06-06 00:00:00             5.45              9.5              3.2
## # … with 3,014 more rows, and 29 more variables:
## #   Temperatura_Intemperie_5cm_Minima &lt;lgl&gt;,
## #   Temperatura_Intemperie_50cm_Minima &lt;lgl&gt;,
## #   Temperatura_Suelo_5cm_Media &lt;lgl&gt;, Temperatura_Suelo_10cm_Media &lt;dbl&gt;,
## #   Temperatura_Inte_5cm &lt;lgl&gt;, Temperatura_Intemperie_150cm_Minima &lt;lgl&gt;,
## #   Humedad_Suelo &lt;lgl&gt;, Precipitacion_Pluviometrica &lt;dbl&gt;,
## #   Precipitacion_Cronologica &lt;dbl&gt;, Precipitacion_Maxima_30minutos &lt;dbl&gt;,
## #   Heliofania_Efectiva &lt;lgl&gt;, Heliofania_Relativa &lt;lgl&gt;,
## #   Tesion_Vapor_Media &lt;dbl&gt;, Humedad_Media &lt;dbl&gt;, Humedad_Media_8_14_20 &lt;dbl&gt;,
## #   Rocio_Medio &lt;dbl&gt;, Duracion_Follaje_Mojado &lt;lgl&gt;,
## #   Velocidad_Viento_200cm_Media &lt;lgl&gt;, Direccion_Viento_200cm &lt;chr&gt;,
## #   Velocidad_Viento_1000cm_Media &lt;lgl&gt;, Direccion_Viento_1000cm &lt;chr&gt;,
## #   Velocidad_Viento_Maxima &lt;lgl&gt;, Presion_Media &lt;lgl&gt;, Radiacion_Global &lt;lgl&gt;,
## #   Horas_Frio &lt;dbl&gt;, Unidades_Frio &lt;dbl&gt;, mes &lt;chr&gt;, Temperatura_kelvin &lt;dbl&gt;,
## #   `15` &lt;dbl&gt;</code></pre>
<p>Recordá que las funciones de {dplyr} nunca modifican la tabla original. <code>mutate()</code> devolvió una nueva tabla que es igual a la tabla <code>bariloche</code> pero con la columna “Temperatura_kelvin” agregada. La tabla <code>bariloche</code> sigue intacta.</p>
<p>Si quisiéramos aplicar la misma operación a todas las columnas que tienen temperatura, la función <code>across()</code> brinda un atajo para no tener que aplicar <code>mutate()</code> una y otra vez a cada cada columna.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a>bariloche <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb33-2"><a href="#cb33-2"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="kw">across</span>(<span class="kw">starts_with</span>(<span class="st">&quot;Temperatura&quot;</span>), <span class="op">~</span>.x <span class="op">+</span><span class="st"> </span><span class="dv">273</span>,<span class="dv">15</span>))</span></code></pre></div>
<pre><code>## # A tibble: 3,024 x 9
##    Temperatura_Abr… Temperatura_Abr… Temperatura_Abr… Temperatura_Int…
##               &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;
##  1              NA               NA               NA                NA
##  2             277.             286.             272.               NA
##  3             275.             282.             270.               NA
##  4             276.             283.             274.               NA
##  5             276.             283.             272.               NA
##  6             279.             286.             276.               NA
##  7             276.             286.             271.               NA
##  8             279.             283.             277.               NA
##  9             278.             280.             276.               NA
## 10             278.             282.             276.               NA
## # … with 3,014 more rows, and 5 more variables:
## #   Temperatura_Intemperie_50cm_Minima &lt;dbl&gt;,
## #   Temperatura_Suelo_5cm_Media &lt;dbl&gt;, Temperatura_Suelo_10cm_Media &lt;dbl&gt;,
## #   Temperatura_Inte_5cm &lt;dbl&gt;, Temperatura_Intemperie_150cm_Minima &lt;dbl&gt;</code></pre>
<p>Varias cosas pasaron acá:</p>
<ul>
<li>El resultado <em>solo</em> incluye las columnas asociadas a la temperatura.</li>
<li>No fue necesario escribir el nombre de cada columna, la función <code>start_with()</code> automáticamente busca las columnas que <em>comienzan con</em> la palabra que indicamos, en este caso “Temperatura”.</li>
<li>Usamos la notación <em>funcional</em> de R, que arranca con <code>~</code> y luego le indicamos que a .x (cada columna) le sume 273,15.</li>
</ul>
<div class="alert alert-info">
<p><strong>Desafío</strong></p>
<p>Si quisieras calcular la temperatura media para cada día y guardarla en una nueva variable, ¿cómo completarías el siguiente código?</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a>bariloche <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb35-2"><a href="#cb35-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">____ =</span> ____)</span></code></pre></div>
</div>
<p>Ahora imaginemos que necesitamos modificar algunas observaciones, aquellas que cumplen con una condición. Por ejemplo, descubrimos que cuando la humedad es 100%, el sensor de temperatura no funciona correctamente y necesitamos aplicarle una corrección de -2° en esas situaciones.</p>
<p>Podríamos filtrar las observaciones que cumplen con que <code>Humedad_Media == 100</code> y luego modificar la temperatura, pero entonces tendríamos una base de datos para las observaciones con mayor humedad y la temperatura corregida y otra base de datos sin la corrección. Necesitamos poder modificar <em>solo algunas</em> observaciones y que el resto se mantenga igual.</p>
<p>Para eso podemos utilizar la función <code>if_else()</code>, que aplica una operación <em>si ocurre algo</em> y otra operación <em>si no</em>. En este caso si <code>Humedad_Media == 100</code> es verdadera, restamos 2 grados a la Temperatura, si es falsa no la modificamos. Y por supuesto se la aplicamos a la columna con <code>mutate()</code></p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a>bariloche <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb36-2"><a href="#cb36-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Temperatura_Abrigo_150cm =</span> <span class="kw">if_else</span>(Humedad_Media <span class="op">==</span><span class="st"> </span><span class="dv">100</span>,       <span class="co"># Condición</span></span>
<span id="cb36-3"><a href="#cb36-3"></a>                                            Temperatura_Abrigo_150cm <span class="dv">-2</span>,<span class="co"># Si es verdadera</span></span>
<span id="cb36-4"><a href="#cb36-4"></a>                                            Temperatura_Abrigo_150cm))  <span class="co"># Si es falsa</span></span></code></pre></div>
<pre><code>## # A tibble: 3,024 x 31
##    Fecha               Temperatura_Abr… Temperatura_Abr… Temperatura_Abr…
##    &lt;dttm&gt;                         &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;
##  1 2011-05-28 00:00:00            NA                NA               NA  
##  2 2011-05-29 00:00:00             4.27             12.8             -1.2
##  3 2011-05-30 00:00:00             1.69              9.2             -2.8
##  4 2011-05-31 00:00:00             3.47              9.6              0.5
##  5 2011-06-01 00:00:00             2.90              9.6             -1.5
##  6 2011-06-02 00:00:00             6.26             13.3              2.9
##  7 2011-06-03 00:00:00             3.45             12.6             -1.8
##  8 2011-06-04 00:00:00             6.09             10.2              3.9
##  9 2011-06-05 00:00:00             3.00              7.1              3.4
## 10 2011-06-06 00:00:00             5.45              9.5              3.2
## # … with 3,014 more rows, and 27 more variables:
## #   Temperatura_Intemperie_5cm_Minima &lt;lgl&gt;,
## #   Temperatura_Intemperie_50cm_Minima &lt;lgl&gt;,
## #   Temperatura_Suelo_5cm_Media &lt;lgl&gt;, Temperatura_Suelo_10cm_Media &lt;dbl&gt;,
## #   Temperatura_Inte_5cm &lt;lgl&gt;, Temperatura_Intemperie_150cm_Minima &lt;lgl&gt;,
## #   Humedad_Suelo &lt;lgl&gt;, Precipitacion_Pluviometrica &lt;dbl&gt;,
## #   Precipitacion_Cronologica &lt;dbl&gt;, Precipitacion_Maxima_30minutos &lt;dbl&gt;,
## #   Heliofania_Efectiva &lt;lgl&gt;, Heliofania_Relativa &lt;lgl&gt;,
## #   Tesion_Vapor_Media &lt;dbl&gt;, Humedad_Media &lt;dbl&gt;, Humedad_Media_8_14_20 &lt;dbl&gt;,
## #   Rocio_Medio &lt;dbl&gt;, Duracion_Follaje_Mojado &lt;lgl&gt;,
## #   Velocidad_Viento_200cm_Media &lt;lgl&gt;, Direccion_Viento_200cm &lt;chr&gt;,
## #   Velocidad_Viento_1000cm_Media &lt;lgl&gt;, Direccion_Viento_1000cm &lt;chr&gt;,
## #   Velocidad_Viento_Maxima &lt;lgl&gt;, Presion_Media &lt;lgl&gt;, Radiacion_Global &lt;lgl&gt;,
## #   Horas_Frio &lt;dbl&gt;, Unidades_Frio &lt;dbl&gt;, mes &lt;chr&gt;</code></pre>
<div class="alert alert-success">
<p>La mayoría de las funciones de R pueden trabajar sobre vectores (y las columnas de un data.frame son como vectores ordenados!) y lo hacen <strong>elemento a elemento</strong>.</p>
<p>En este caso <code>if_else()</code> recorre la columna con la información de humedad y <em>elemento a elemento</em> revisa si el valor es igual a 100. Luego decide si debe modificar o no cada elemento, en el orden en el que aparecen.</p>
</div>
<div class="alert alert-info">
<p><strong>Desafío</strong></p>
<p>Ahora es tu turno, “arreglá” las variables <code>Temperatura_Abrigo_150cm_Maxima</code> y <code>Temperatura_Abrigo_150cm_Minima</code> para aplicar la misma corrección de 2 grados.</p>
</div>
</div>
<div id="desagrupando-con-ungroup" class="section level2">
<h2>Desagrupando con <code>ungroup()</code></h2>
<p>En general, la mayoría de las funciones de {dplyr} “entienden” cuando una tabla está agrupada y realizan las operaciones para cada grupo.</p>
<div class="alert alert-info">
<p><strong>Desafío:</strong></p>
<p>¿Cuál de estos dos códigos agrega una columna llamada “Temperatura_max_media” con el la temperatura máxima media para cada mes? ¿Qué hace el otro?</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a>bariloche <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb38-2"><a href="#cb38-2"></a><span class="st">  </span><span class="kw">group_by</span>(mes) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb38-3"><a href="#cb38-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Temperatura_max_media =</span> <span class="kw">mean</span>(Temperatura_Abrigo_150cm_Maxima, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) </span>
<span id="cb38-4"><a href="#cb38-4"></a></span>
<span id="cb38-5"><a href="#cb38-5"></a>bariloche <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb38-6"><a href="#cb38-6"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Temperatura_max_media =</span> <span class="kw">mean</span>(Temperatura_Abrigo_150cm_Maxima, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))  </span></code></pre></div>
</div>
<p>En otras palabras, los resultados de <code>mutate()</code>, <code>filter()</code>, <code>summarise()</code> y otras funciones cambian según si la tabla está agrupada o no. Como a veces uno se puede olvidar que quedaron grupos, es conveniente usar la función <code>ungroup()</code> una vez que dejás de trabajar con grupos:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a>bariloche <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb39-2"><a href="#cb39-2"></a><span class="st">  </span><span class="kw">group_by</span>(mes) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb39-3"><a href="#cb39-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Temperatura_max_media =</span> <span class="kw">mean</span>(Temperatura_Abrigo_150cm_Maxima, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span><span class="st">  </span></span>
<span id="cb39-4"><a href="#cb39-4"></a><span class="st">  </span><span class="kw">ungroup</span>()</span></code></pre></div>
<pre><code>## # A tibble: 3,024 x 32
##    Fecha               Temperatura_Abr… Temperatura_Abr… Temperatura_Abr…
##    &lt;dttm&gt;                         &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;
##  1 2011-05-28 00:00:00            NA                NA               NA  
##  2 2011-05-29 00:00:00             4.27             12.8             -1.2
##  3 2011-05-30 00:00:00             1.69              9.2             -2.8
##  4 2011-05-31 00:00:00             3.47              9.6              0.5
##  5 2011-06-01 00:00:00             2.90              9.6             -1.5
##  6 2011-06-02 00:00:00             6.26             13.3              2.9
##  7 2011-06-03 00:00:00             3.45             12.6             -1.8
##  8 2011-06-04 00:00:00             6.09             10.2              3.9
##  9 2011-06-05 00:00:00             5.00              7.1              3.4
## 10 2011-06-06 00:00:00             5.45              9.5              3.2
## # … with 3,014 more rows, and 28 more variables:
## #   Temperatura_Intemperie_5cm_Minima &lt;lgl&gt;,
## #   Temperatura_Intemperie_50cm_Minima &lt;lgl&gt;,
## #   Temperatura_Suelo_5cm_Media &lt;lgl&gt;, Temperatura_Suelo_10cm_Media &lt;dbl&gt;,
## #   Temperatura_Inte_5cm &lt;lgl&gt;, Temperatura_Intemperie_150cm_Minima &lt;lgl&gt;,
## #   Humedad_Suelo &lt;lgl&gt;, Precipitacion_Pluviometrica &lt;dbl&gt;,
## #   Precipitacion_Cronologica &lt;dbl&gt;, Precipitacion_Maxima_30minutos &lt;dbl&gt;,
## #   Heliofania_Efectiva &lt;lgl&gt;, Heliofania_Relativa &lt;lgl&gt;,
## #   Tesion_Vapor_Media &lt;dbl&gt;, Humedad_Media &lt;dbl&gt;, Humedad_Media_8_14_20 &lt;dbl&gt;,
## #   Rocio_Medio &lt;dbl&gt;, Duracion_Follaje_Mojado &lt;lgl&gt;,
## #   Velocidad_Viento_200cm_Media &lt;lgl&gt;, Direccion_Viento_200cm &lt;chr&gt;,
## #   Velocidad_Viento_1000cm_Media &lt;lgl&gt;, Direccion_Viento_1000cm &lt;chr&gt;,
## #   Velocidad_Viento_Maxima &lt;lgl&gt;, Presion_Media &lt;lgl&gt;, Radiacion_Global &lt;lgl&gt;,
## #   Horas_Frio &lt;dbl&gt;, Unidades_Frio &lt;dbl&gt;, mes &lt;chr&gt;,
## #   Temperatura_max_media &lt;dbl&gt;</code></pre>
<div class="btn-group" role="group" aria-label="Navegación">
<p><a href= "04-lectura.html" class = "btn btn-primary">Anterior</a> <a href= "06-dplyr-tidyr-II.html" class = "btn btn-primary">Siguiente</a></p>
</div>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiTWFuaXB1bGFjacOzbiBkZSBkYXRvcyBvcmRlbmFkb3MgdXNhbmRvIHtkcGx5cn0gLSBQcmltZXJhIHBhcnRlIgpvdXRwdXQ6IAogIGh0bWxfZG9jdW1lbnQ6CiAgICBjb2RlX2Rvd25sb2FkOiB0cnVlCiAgICB0b2M6IHRydWUKICAgIHRvY19mbG9hdDogdHJ1ZQogICAgaGlnaGxpZ2h0OiB0YW5nbwotLS0KCmBgYHtyIHNldHVwLCBpbmNsdWRlPUZBTFNFfQprbml0cjo6b3B0c19jaHVuayRzZXQoZWNobyA9IFRSVUUpCmBgYAoKCkVsIHBhcXVldGUge2RwbHlyfSBwcm92ZWUgdW5hIGVub3JtZSBjYW50aWRhZCBkZSBmdW5jaW9uZXMgw7p0aWxlcyBwYXJhIG1hbmlwdWxhciB5IGFuYWxpemFyIGRhdG9zIGRlIG1hbmVyYSBpbnR1aXRpdmEgeSBleHByZXNpdmEuIAoKRWwgZXNww61yaXR1IGRldHLDoXMgZGUge2RwbHlyfSBlcyBxdWUgbGEgZW5vcm1lIG1heW9yw61hIGRlIGxvcyBhbsOhbGlzaXMsIHBvciBtw6FzIGNvbXBsaWNhZG9zIHF1ZSBzZWFuLCBpbnZvbHVjcmFuIGNvbWJpbmFyIHkgZW5jYWRlbmFyIHVuYSBzZXJpZSByZWxhdGl2YW1lbnRlIGFjb3RhZGEgZGUgYWNjaW9uZXMgKG8gdmVyYm9zKS4gVmFtb3MgYSBjb21lbnphciBhIHRyYWJhamFyIGNvbiBsYXMgY2luY28gbcOhcyBjb211bmVzOgoKICAqIGBzZWxlY3QoKWA6IHNlbGVjY2lvbmEgY29sdW1uYXMgZGUgdW5hIHRhYmxhLgogICogYGZpbHRlcigpYDogc2VsZWNjaW9uYSAobyBmaWx0cmEpIGZpbGFzIGRlIHVuYSB0YWJsYSBhIHBhcnRpciBkZSB1bmEgbyBtw6FzIGNvbmRpY2lvbmVzIGzDs2dpY2FzLgogICogYGdyb3VwX2J5KClgOiBhZ3J1cGEgdW5hIHRhYmxhIGVuIGJhc2UgYWwgdmFsb3IgZGUgdW5hIG8gbcOhcyBjb2x1bW5hcy4KICAqIGBtdXRhdGUoKWA6IGFncmVnYSBudWV2YXMgY29sdW1uYXMgYSB1bmEgdGFibGEuCiAgKiBgc3VtbWFyaXNlKClgOiBjYWxjdWxhIGVzdGFkw61zdGljYXMgcGFyYSBjYWRhIGdydXBvIGRlIHVuYSB0YWJsYS4KCjo6OiB7LmFsZXJ0IC5hbGVydC1pbmZvfQoqKlByaW1lciBkZXNhZsOtbzoqKgoKVGUgZGllcm9uIHVuYSB0YWJsYSBjb24gZGF0b3MgZGUgdGVtcGVyYXR1cmEgbcOtbmltYSB5IG3DoXhpbWEgcGFyYSBkaXN0aW50YXMgZXN0YWNpb25lcyBtZXRlb3JvbMOzZ2ljYXMgZGUgdG9kbyBlbCBwYcOtcyBkdXJhbnRlIGxvcyAzNjUgZMOtYXMgZGUgdW4gYcOxby4gTGFzIGNvbHVtbmFzIHNvbjogYGlkX2VzdGFjaW9uYCwgYHRlbXBlcmF0dXJhX21heGltYWAsIGB0ZW1wZXJhdHVyYV9taW5pbWFgIHkgYHByb3ZpbmNpYWAuIEVuIGJhc2UgYSBlc29zIGRhdG9zLCB0ZSBwaWRlbiBxdWUgY29tcHV0ZW4gbGEgdGVtcGVyYXR1cmEgbWVkaWEgYW51YWwgZGUgY2FkYSBlc3RhY2nDs24gw7puaWNhbWVudGUgZGUgbGFzIGVzdGFjaW9uZXMgZGUgTGEgUGFtcGEuIAoKwr9FbiBxdcOpIG9yZGVuIGVqZWN1dGFyw61hcyBlc3RvcyBwYXNvcyBwYXJhIG9idGVuZXIgZWwgcmVzdWx0YWRvIGRlc2VhZG8/IFRvZGF2w61hIHNpbiBjb3JyZXIgbmluZ3VuYSBsw61uZWEgZGUgY8OzZGlnby4KCiogdXNhciBgc3VtbWFyaXNlKClgIHBhcmEgY2FsY3VsYXIgbGEgZXN0YWTDrXN0aWNhIGBtZWFuKHRlbXBlcmF0dXJhX21lZGlhKWAgcGFyYSBjYWRhIGBpZF9lc3RhY2lvbmAKKiB1c2FyIGBncm91cF9ieSgpYCBwYXJhIGFncnVwYXIgcG9yIGxhIGNvbHVtbmEgYGlkX2VzdGFjaW9uYAoqIHVzYXIgYG11dGF0ZSgpYCBwYXJhIGFncmVnYXIgdW5hIGNvbHVtbmEgbGxhbWFkYSBgdGVtcGVyYXR1cmFfbWVkaWFgIHF1ZSBzZWEgYCh0ZW1wZXJhdHVyYV9taW5pbWEgKyB0ZW1wZXJhdHVyYV9tYXhpbWEpLzJgLgoqIHVzYXIgYGZpbHRlcigpYCBwYXJhIHNlbGVjY2lvbmFyIHNvbG8gbGFzIGZpbGFzIGRvbmRlIGxhIGNvbHVtbmFzIGBwcm92aW5jaWFgIGVzIGlndWFsIGEgIkxhIFBhbXBhIgo6OjoKClBhcmEgdXNhciB7ZHBseXJ9IHByaW1lcm8gaGF5IHF1ZSBpbnN0YWxhcmxvIGNvbiBlbCBjb21hbmRvOgoKYGBge3IsIGV2YWwgPSBGQUxTRX0KaW5zdGFsbC5wYWNrYWdlcygnZHBseXInKQpgYGAKCm8ganVudG8gY29uIHRvZG9zIGxvcyBwYXF1ZXRlcyBkZWwgdW5pdmVyc28gZGUgVGlkeXZlcnNlIHkgbHVlZ28gY2FyZ2FybG8gZW4gbWVtb3JpYSBjb24KCmBgYHtyfQpsaWJyYXJ5KGRwbHlyKQpgYGAKCkNhcmdhciBsb3MgZGF0b3MgZGUgbGEgZXN0YWNpw7NuIGRlIEJhcmlsb2NoZSAocGFyYSB1biByZWNvcmRhdG9yaW8sIHBvZMOpcyBpciBhIFtMZWN0dXJhIGRlIGRhdG9zIG9yZGVuYWRvc10oMDQtbGVjdHVyYS1kYXRvcy5odG1sKSk6CgpgYGB7cn0KbGlicmFyeShyZWFkcikKYmFyaWxvY2hlIDwtIHJlYWRfY3N2KCJkYXRvcy9iYXJpbG9jaGVfZW5saW1waW8uY3N2IikKYGBgCgojIyBTZWxlY2Npb25hbmRvIGNvbHVtbmFzIGNvbiBgc2VsZWN0KClgCgpQYXJhIHF1ZWRhcnNlIMO6bmljYW1lbnRlIGNvbiBsYXMgY29sdW1uYXMgZGUgRmVjaGEsIFRlbXBlcmF0dXJhX0Ficmlnb18xNTBjbSB5IEh1bWVkYWRfTWVkaWEgcG9kw6lzIHVzYXIgYHNlbGVjdCgpYCwgZWwgcHJpbWVyIGFyZ3VtZW50byBlcyBzaWVtcHJlIGVsIGRhdGEuZnJhbWU6CiAgCmBgYHtyfQpzZWxlY3QoYmFyaWxvY2hlLCBGZWNoYSwgVGVtcGVyYXR1cmFfQWJyaWdvXzE1MGNtLCBIdW1lZGFkX01lZGlhKSAjIE9qbyBjb24gbGFzIG1hecO6c2N1bGFzIQpgYGAKCsK/RMOzbmRlIHF1ZWTDsyBlc3RlIHJlc3VsdGFkbz8gU2kgdGUgZmlqw6FzIGVuIGxhIHZhcmlhYmxlIGBiYXJpbG9jaGVgLCDDqXN0YSBlc3TDoSBpbnRhY3RhOgoKYGBge3J9CmJhcmlsb2NoZQpgYGAKCmBzZWxlY3QoKWAgeSBlbCByZXN0byBkZSBsYXMgZnVuY2lvbmVzIGRlIHtkcGx5cn0gc2llbXByZSBnZW5lcmFuIHVuYSBudWV2YSB0YWJsYSB5IG51bmNhIG1vZGlmaWNhbiBsYSB0YWJsYSBvcmlnaW5hbC4gUGFyYSBndWFyZGFyIGxhIHRhYmxhIGNvbiBsYXMgdHJlcyBjb2x1bW5hcyBgRmVjaGFgLCBgVGVtcGVyYXR1cmFfQWJyaWdvXzE1MGNtYCB5IGBIdW1lZGFkX01lZGlhYCB0ZW7DqXMgcXVlIGFzaWduYXIgZWwgcmVzdWx0YWRvIGEgdW5hIG51ZXZhIHZhcmlhYmxlLgoKYGBge3J9CnRlbXBfaHVtIDwtIHNlbGVjdChiYXJpbG9jaGUsIEZlY2hhLCBUZW1wZXJhdHVyYV9BYnJpZ29fMTUwY20sIEh1bWVkYWRfTWVkaWEpCnRlbXBfaHVtCmBgYAoKIVtDw7NtbyBmdW5jaW9uYSBgc2VsZWN0KClgXShpbWcvZHBseXItc2VsZWN0LnBuZykKCiMjIEZpbHRyYW5kbyBmaWxhcyBjb24gYGZpbHRlcigpYAoKQWhvcmEgcG9kw6lzIHVzYXIgYGZpbHRlcigpYCBwYXJhIHF1ZWRhcnRlIGNvbiBzw7NsbyB1bmFzIGZpbGFzLiBQb3IgZWplbXBsbywgcGFyYSB2ZXIgYXF1ZWxsb3MgZMOtYXMgY29uIHRlbXBlcmF0dXJhIG1lbm9yIGEgMCBncmFkb3M6CgpgYGB7cn0KZmlsdGVyKHRlbXBfaHVtLCBUZW1wZXJhdHVyYV9BYnJpZ29fMTUwY20gPCAwKQpgYGAKCkxhIG1heW9yw61hIGRlIGxvcyBhbsOhbGlzaXMgY29uc2lzdGVuIGVuIHZhcmlvcyBwYXNvcyAoZW4gZWwgcHJpbWVyIGRlc2Fmw61vIHVzYXN0ZSA0IHBhc29zIHBhcmEgY2FsY3VsYXIgbGFzIHRlbXBlcmF0dXJhcyBtZWRpYXMgZGUgdW5hIHNlcmllIGRlIGVzdGFjaW9uZXMpLiBMYSDDum5pY2EgdGFibGEgcXVlIHRlIGludGVyZXNhIGVzIGxhIMO6bHRpbWEsIHBvciBsbyBxdWUgaXIgYXNpZ25hbmRvIHZhcmlhYmxlcyBudWV2YXMgZW4gY2FkYSBwYXNvIGludGVybWVkaW8gZXMgdGVkaW9zbyB5IHBvY28gcHLDoWN0aWNvLiBQYXJhIGVzbyBzZSB1c2EgZWwgb3BlcmFkb3IgJ3BpcGUnIChgJT4lYCkuIAoKRWwgb3BlcmFkb3IgJ3BpcGUnIChgJT4lYCkgYWdhcnJhIGVsIHJlc3VsdGFkbyBkZSB1bmEgZnVuY2nDs24geSBzZSBsbyBwYXNhIGEgbGEgc2lndWllbnRlLiBFc3RvIHBlcm1pdGUgZXNjcmliaXIgZWwgY8OzZGlnbyBjb21vIHVuYSBjYWRlbmEgZGUgZnVuY2lvbmVzIHF1ZSB2YW4gb3BlcmFuZG8gc29icmUgZWwgcmVzdWx0YWRvIGRlIGxhIGFudGVyaW9yLgoKTGFzIGRvcyBvcGVyYWNpb25lcyBhbnRlcmlvcmVzIChzZWxlY2Npb25hciB0cmVzIGNvbHVtbmFzIHkgbHVlZ28gZmlsdGFyIGxhcyBmaWxhcyBjb3JyZXNwb25kaWVudGVzIHRlbXBlcmF0dXJhcyBtZW5vcmVzIGEgMMKwQykgc2UgcHVlZGVuIGVzY3JpYmlyIHVubyBkZXNwdcOpcyBkZWwgb3RybyB5IHNpbiBhc2lnbmFyIGxvcyByZXN1bHRhZG9zIGludGVybWVkaW9zIGEgbnVldmFzIHZhcmlhYmxlcyBkZSBlc3RhIGZvcm1hOgoKYGBge3J9CmJhcmlsb2NoZSAlPiUgCiAgc2VsZWN0KEZlY2hhLCBUZW1wZXJhdHVyYV9BYnJpZ29fMTUwY20sIEh1bWVkYWRfTWVkaWEpICU+JSAKICBmaWx0ZXIoVGVtcGVyYXR1cmFfQWJyaWdvXzE1MGNtIDwgMCkKYGBgCgpMYSBmb3JtYSBkZSAibGVlciIgZXN0byBlcyAiVG9tw6EgbGEgdmFyaWFibGUgYGJhcmlsb2NoZWAsICoqZGVzcHXDqXMqKiBhcGxpY2FsZSBgc2VsZWN0KEZlY2hhLCBUZW1wZXJhdHVyYV9BYnJpZ29fMTUwY20sIEh1bWVkYWRfTWVkaWEpYCwgKipkZXNwdcOpcyoqIGFwbGljYWxlIGBmaWx0ZXIoVGVtcGVyYXR1cmFfQWJyaWdvXzE1MGNtIDwgMClgIi4gCgpDw7NtbyB2aW1vcywgZWwgcHJpbWVybyBhcmd1bWVudG8gZGUgdG9kYXMgbGFzIGZ1bmNpb25lcyBkZSBkcGx5ciBlc3BlcmEgdW4gZGF0YS5mcmFtZSB5IGp1c3RhbWVudGUgZWwgb3BlcmFkb3IgYCU+JWAgdG9tYSBlbCBkYXRhLmZyYW1lIGBiYXJpbG9jaGVgIHkgc2UgbG8gcGFzYSBhbCBwcmltZXIgYXJndW1lbnRvIGRlIGBzZWxlY3QoKWAuIEx1ZWdvIGVsIGRhdGEuZnJhbWUgcmVzdWx0YW50ZSBkZSBzZWxlY2Npb25hciBsYXMgY29sdW1uYXMgRmVjaGEsIFRlbXBlcmF0dXJhX0Ficmlnb18xNTBjbSB5IEh1bWVkYWRfTWVkaWEgKnBhc2EqIGNvbW8gZWwgcHJpbWVyIGFyZ3VtZW50byBkZSBsYSBmdW5jacOzbiBgZmlsdGVyKClgIGdyYWNpYXMgYWwgYCU+JWAuCgoKOjo6IHsuYWxlcnQgLmFsZXJ0LXN1Y2Nlc3N9CioqVGlwOioqCgpFbiBSU3R1ZGlvIHBvZMOpcyBlc2NyaWJpciBgJT4lYCB1c2FuZG8gZWwgYXRham8gZGUgdGVjbGFkbyBDdHIgKyBTaGlmdCArIE0uIMKhUHJvYmFsbyEKOjo6CgoKOjo6IHsuYWxlcnQgLmFsZXJ0LWluZm99CioqRGVzYWbDrW86KioKCkNvbXBsZXTDoSBlc3RhIGNhZGVuYSBwYXJhIHByb2R1Y2lyIHVuYSB0YWJsYSBxdWUgY29udGVuZ2EgbG9zIHZhbG9yZXMgZGUgRmVjaGEsIFRlbXBlcmF0dXJhIGRlbCBzdWVsbyB5IGxhIEh1bWVkYWQgw7puaWNhbWVudGUgY3VhbmRvIGxhIEh1bWVkYWQgZXMgaWd1YWwgYSAxMDAlLiAKCmBgYHtyLCBldmFsID0gRkFMU0V9CmJhcmlsb2NoZSAlPiUgCiAgZmlsdGVyKEh1bWVkYWRfTWVkaWEgPT0gX19fKSAlPiUKICBzZWxlY3QoX19fLCBfX18sIF9fXykKYGBgCgo6OjoKCiMjIEFncnVwYW5kbyB5IHJlZHVjaWVuZG8gY29uIGBncm91cF9ieSgpICU+JSBzdW1tYXJpc2UoKWAKClNpIHF1ZXLDqXMgY2FsY3VsYXIgbGEgdGVtcGVyYXR1cmEgbWVkaWEgcGFyYSBjYWRhIG1lcywgdGVuw6lzIHF1ZSB1c2FyIGVsIGNvbWJvIGBncm91cF9ieSgpICU+JSBzdW1tYXJpc2UoKWAuIEVzIGRlY2lyLCBwcmltZXJvIGFncnVwYXIgbGEgdGFibGEgc2Vnw7puIGxhIGNvbHVtbmEgYG1lc2AgeSBsdWVnbyBjYWxjdWxhciB1biBwcm9tZWRpbyBkZSBgVGVtcGVyYXR1cmFfQWJyaWdvXzE1MGNtYCBwYXJhIGNhZGEgZ3J1cG8uCgpQYXJhIGFncnVwYXIgbGEgdGFibGEgYGJhcmlsb2NoZWAgc2Vnw7puIGVsIG1lcyB1c2Ftb3MgZWwgc2lndWllbnRlIGPDs2RpZ286CgpgYGB7cn0KYmFyaWxvY2hlICU+JSAKICBncm91cF9ieShtZXMpIApgYGAKCkEgcHJpbWVyYSB2aXN0YSBwYXJlY2Vyw61hIHF1ZSBsYSBmdW5jacOzbiBubyBoaXpvIG5hZGEsIHBlcm8gZmlqYXRlIHF1ZSBlbCByZXN1bHRhZG8gYWhvcmEgZGljZSBxdWUgdGllbmUgZ3J1cG9zICgiR3JvdXBzOiAiKSwgeSBub3MgZGljZSBxdcOpIGNvbHVtbmEgZXMgbGEgcXVlIGFncnVwYSBsb3MgZGF0b3MgKCJtZXMiKSB5IGN1w6FudG9zIGdydXBvcyBoYXkgKCIxMiIpLiBMYXMgb3BlcmFjaW9uZXMgc3Vic2lndWllbnRlcyBxdWUgbGUgaGFnYW1vcyBhIGVzdGEgdGFibGEgdmFuIGEgaGFjZXJzZSAqcGFyYSBjYWRhIGdydXBvKi4gCgpQYXJhIHZlciBlc3RvIGVuIGFjY2nDs24sIHVzw6EgYHN1bW1hcmlzZSgpYCBwYXJhIGNvbXB1dGFyIGVsIHByb21lZGlvIGRlIGxhIHRlbXBlcmF0dXJhOgoKYGBge3J9CmJhcmlsb2NoZSAlPiUgCiAgZ3JvdXBfYnkobWVzKSAlPiUgCiAgc3VtbWFyaXNlKFRlbXBlcmF0dXJhX21lZGlhID0gbWVhbihUZW1wZXJhdHVyYV9BYnJpZ29fMTUwY20pKQpgYGAKCsKhVGFkw6EhIGBzdW1tYXJpc2UoKWAgZGV2dWVsdmUgdW5hIHRhYmxhIGNvbiB1bmEgY29sdW1uYSBwYXJhIGVsIGNvbnRpbmVudGUgeSBvdHJhIG51ZXZhLCBsbGFtYWRhICJUZW1wZXJhdHVyYV9tZWRpYSIgcXVlIGNvbnRpZW5lIGVsIHByb21lZGlvIGRlIGBUZW1wZXJhdHVyYV9BYnJpZ29fMTUwY21gIHBhcmEgY2FkYSBncnVwby4gUGVyby4uLiBhcGFyZWNlbiBtdWNob3MgZGF0b3MgZmFsdGFudGVzLCBjdWFuZG8gZW4gcmVhbGlkYWQgaGF5IG11Y2hhcyBvYnNlcnZhY2lvbmVzIHBhcmEgY2FkYSBtZXMuIAoKU2kgcmV2aXNhbW9zIGxhIGF5dWRhIGRlIGxhIGZ1bmNpw7NuIGBtZWFuKClgLCB2ZW1vcyBxdWUgdGllbmUgdW4gYXJndW1lbnRvIHF1ZSBwb3IgZGVmZWN0byBlcyBgbmEucm0gPSBGQUxTRWAsIGVzdG8gc2lnbmlmaWNhIHF1ZSBzaSBhbCBtZW5vcyB1bmEgb2JzZXJ2YWNpw7NuIGVzIGBOQWAsIGVsIHJlc3VsdGFkbyBzZXLDoSBgTkFgLiBDYW1iaWVtb3MgZXN0ZSBhcmd1bWVudG8gYSBgVFJVRWAgcGFyYSBjYW1iaWFyIGVsIGNvbXBvcnRhbWllbnRvIGRlIGxhIGZ1bmNpw7NuLgoKYGBge3J9CmJhcmlsb2NoZSAlPiUgCiAgZ3JvdXBfYnkobWVzKSAlPiUgCiAgc3VtbWFyaXNlKFRlbXBlcmF0dXJhX21lZGlhID0gbWVhbihUZW1wZXJhdHVyYV9BYnJpZ29fMTUwY20sIG5hLnJtID0gVFJVRSkpCmBgYAoKQWhvcmEgc2ksIHRlbmVtb3MgbGEgdGVtcGVyYXR1cmEgbWVkaWEgcGFyYSBjYWRhIG1lcy4gYGdyb3VwX2J5KClgIHBlcm1pdGUgYWdydXBhciBlbiBiYXNlIGEgbcO6bHRpcGxlcyBjb2x1bW5hcyB5IGBzdW1tYXJpc2UoKWAgcGVybWl0ZSBnZW5lcmFyIG3Dumx0aXBsZXMgY29sdW1uYXMgZGUgcmVzdW1lbi4gRWwgcmVzdWx0YWRvIHZhIGEgc2llbXByZSBzZXIgdW5hIHRhYmxhIGNvbiBsYSBtaXNtYSBjYW50aWRhZCBkZSBmaWxhcyBxdWUgZ3J1cG9zIHkgdW5hIGNhbnRpZGFkIGRlIGNvbHVtbmFzIGlndWFsIGEgbGEgY2FudGlkYWQgZGUgY29sdW1uYXMgdXNhZGFzIHBhcmEgYWdydXBhciB5IGxvcyBlc3RhZMOtc3RpY29zIGNvbXB1dGFkb3MuIAoKOjo6IHsuYWxlcnQgLmFsZXJ0LWluZm99CioqRGVzYWbDrW86KioKCsK/Q3XDoWwgdGUgaW1hZ2luw6FzIHF1ZSB2YSBhIHNlciBlbCByZXN1bHRhZG8gZGVsIHNpZ3VpZW50ZSBjw7NkaWdvPyDCv0N1w6FudGFzIGZpbGFzIHkgY29sdW1uYXMgdmEgYSB0ZW5lcj8gKFRyYXTDoSBkZSBwZW5zYXJsbyBhbnRlcyBkZSBjb3JyZXJsby4pCgpgYGB7ciwgZXZhbCA9IEZBTFNFfQpiYXJpbG9jaGUgJT4lIAogIHN1bW1hcmlzZShUZW1wZXJhdHVyYV9tZWRpYSA9IG1lYW4oVGVtcGVyYXR1cmFfQWJyaWdvXzE1MGNtKSkKYGBgCjo6OgoKRWwgY29tYm8gYGdyb3VwX2J5KCkgJT4lIHN1bW1hcmlzZSgpYCBzZSBwdWVkZSByZXN1bWlyIGVuIGVzdGEgZmlndXJhLiBMYXMgZmlsYXMgZGUgdW5hIHRhYmxhIHNlIGRpdmlkZW4gZW4gZ3J1cG9zLCB5IGx1ZWdvIGNhZGEgZ3J1cG8gc2UgInJlc3VtZSIgZW4gdW5hIGZpbGEgZW4gZnVuY2nDs24gZGVsIGVzdGFkw61zdGljbyB1c2Fkby4gCgohW10oaW1nL2dyb3VwX2J5LXN1bW1hcml6ZS5wbmcpCgpBbCBpZ3VhbCBxdWUgaGljaW1vcyAiY3VlbnRhcyIgdXNhbmRvIGFsZ3VuYXMgdmFyaWFibGVzIG51bcOpcmljYXMgcGFyYSBvYnRlbmVyIGluZm9ybWFjacOzbiBudWV2YSwgdGFtYmnDqW4gcG9kZW1vcyB1dGlsaXphciB2YXJpYWJsZXMgY2F0ZWfDs3JpY2FzLiBObyB0aWVuZSBzZW50aWRvIGNhbGN1bGFyIGBtZWFuKG1lcylgIHlhIHF1ZSBjb250aWVuZW4gY2FyYWN0ZXJlcywgcGVybyB0YWwgdmV6IG5vcyBpbnRlcmVzZSAqY29udGFyKiBsYSBjYW50aWRhZCBkZSBvYnNlcnZhY2lvbmVzIHBvciBtZXM6CgpgYGB7cn0KYmFyaWxvY2hlICU+JSAKICBncm91cF9ieShtZXMpICU+JSAKICBzdW1tYXJpc2UoY2FudGlkYWQgPSBuKCkpCmBgYAoKOjo6ey5hbGVydCAuYWxlcnQtc3VjY2Vzc30KCkVuIFIgc2UgcHVlZGUgcmVzb2x2ZXIgdW4gcHJvYmxlbWEgZGUgbXVjaGFzIG1hbmVyYXMsIHBvciBlamVtcGxvLCBlbCBjw7NkaWdvIGFudGVyaW9yIHkgZWwgcXVlIHNpZ3VlIGRhbiByZXN1bHRhZG9zIGVxdWl2YWxlbnRlczoKYGBge3J9CmJhcmlsb2NoZSAlPiUgCiAgZ3JvdXBfYnkobWVzKSAlPiUgCiAgY291bnQoKQpgYGAKCkVuIGVzdGUgY2FzbyBgY291bnQoKWAgZXMgYW7DoWxvZ28gYSBgc3VtbWFyaXNlKGNhbnRpZGFkID0gbigpKWAuCjo6OgoKIyMgQ3JlYW5kbyBudWV2YXMgY29sdW1uYXMgY29uIGBtdXRhdGUoKWAKClRvZG8gZXN0byBlc3TDoSBiaWVuIHBhcmEgaGFjZXIgY8OhbGN1bG9zIGNvbiBjb2x1bW5hcyBwcmV2aWFtZW50ZSBleGlzdGVudGVzLCBwZXJvIG11Y2hhcyB2ZWNlcyB0ZW7DqXMgcXVlIGNyZWFyIG51ZXZhcyBjb2x1bW5hcy4gCgpMYSB0YWJsYSBgYmFyaWxvY2hlYCB0aWVuZSBpbmZvcm1hY2nDs24gZGUgdGVtcGVyYXR1cmFzIGVuIGdyYWRvcyBjZW50w61ncmFkb3MgeSBwdWVkZSBzZXIgbmVjZXNhcmlvIGNvbnZlcnRpcmxhcyBhIGtlbHZpbi4gYG11dGF0ZSgpYCBwZXJtaXRlIGFncmVnYXIgdW5hIG51ZXZhIGNvbHVtbmEgbGxhbWFkYSAiVGVtcGVyYXR1cmFfa2VsdmluIiBjb24gZXNhIGluZm9ybWFjacOzbjoKCmBgYHtyfQpiYXJpbG9jaGUgJT4lIAogIG11dGF0ZShUZW1wZXJhdHVyYV9rZWx2aW4gPSBUZW1wZXJhdHVyYV9BYnJpZ29fMTUwY20gKyAyNzMsMTUpCmBgYAoKUmVjb3Jkw6EgcXVlIGxhcyBmdW5jaW9uZXMgZGUge2RwbHlyfSBudW5jYSBtb2RpZmljYW4gbGEgdGFibGEgb3JpZ2luYWwuIGBtdXRhdGUoKWAgZGV2b2x2acOzIHVuYSBudWV2YSB0YWJsYSBxdWUgZXMgaWd1YWwgYSBsYSB0YWJsYSBgYmFyaWxvY2hlYCBwZXJvIGNvbiBsYSBjb2x1bW5hICJUZW1wZXJhdHVyYV9rZWx2aW4iIGFncmVnYWRhLiBMYSB0YWJsYSBgYmFyaWxvY2hlYCBzaWd1ZSBpbnRhY3RhLgoKU2kgcXVpc2nDqXJhbW9zIGFwbGljYXIgbGEgbWlzbWEgb3BlcmFjacOzbiBhIHRvZGFzIGxhcyBjb2x1bW5hcyBxdWUgdGllbmVuIHRlbXBlcmF0dXJhLCBsYSBmdW5jacOzbiBgYWNyb3NzKClgIGJyaW5kYSB1biBhdGFqbyBwYXJhIG5vIHRlbmVyIHF1ZSBhcGxpY2FyIGBtdXRhdGUoKWAgdW5hIHkgb3RyYSB2ZXogYSBjYWRhIGNhZGEgY29sdW1uYS4KCmBgYHtyfQpiYXJpbG9jaGUgJT4lIAogIHN1bW1hcmlzZShhY3Jvc3Moc3RhcnRzX3dpdGgoIlRlbXBlcmF0dXJhIiksIH4ueCArIDI3MywxNSkpCmBgYAoKVmFyaWFzIGNvc2FzIHBhc2Fyb24gYWPDoToKCi0gRWwgcmVzdWx0YWRvICpzb2xvKiBpbmNsdXllIGxhcyBjb2x1bW5hcyBhc29jaWFkYXMgYSBsYSB0ZW1wZXJhdHVyYS4KLSBObyBmdWUgbmVjZXNhcmlvIGVzY3JpYmlyIGVsIG5vbWJyZSBkZSBjYWRhIGNvbHVtbmEsIGxhIGZ1bmNpw7NuIGBzdGFydF93aXRoKClgIGF1dG9tw6F0aWNhbWVudGUgYnVzY2EgbGFzIGNvbHVtbmFzIHF1ZSAqY29taWVuemFuIGNvbiogbGEgcGFsYWJyYSBxdWUgaW5kaWNhbW9zLCBlbiBlc3RlIGNhc28gIlRlbXBlcmF0dXJhIi4KLSBVc2Ftb3MgbGEgbm90YWNpw7NuICpmdW5jaW9uYWwqIGRlIFIsIHF1ZSBhcnJhbmNhIGNvbiBgfmAgeSBsdWVnbyBsZSBpbmRpY2Ftb3MgcXVlIGEgLnggKGNhZGEgY29sdW1uYSkgbGUgc3VtZSAyNzMsMTUuIAoKOjo6ey5hbGVydCAuYWxlcnQtaW5mb30KCioqRGVzYWbDrW8qKgoKU2kgcXVpc2llcmFzIGNhbGN1bGFyIGxhIHRlbXBlcmF0dXJhIG1lZGlhIHBhcmEgY2FkYSBkw61hIHkgZ3VhcmRhcmxhIGVuIHVuYSBudWV2YSB2YXJpYWJsZSwgwr9jw7NtbyBjb21wbGV0YXLDrWFzIGVsIHNpZ3VpZW50ZSBjw7NkaWdvPwoKYGBge3IgZXZhbD1GQUxTRX0KYmFyaWxvY2hlICU+JSAKICBtdXRhdGUoX19fXyA9IF9fX18pCmBgYAo6OjoKCkFob3JhIGltYWdpbmVtb3MgcXVlIG5lY2VzaXRhbW9zIG1vZGlmaWNhciBhbGd1bmFzIG9ic2VydmFjaW9uZXMsIGFxdWVsbGFzIHF1ZSBjdW1wbGVuIGNvbiB1bmEgY29uZGljacOzbi4gUG9yIGVqZW1wbG8sIGRlc2N1YnJpbW9zIHF1ZSBjdWFuZG8gbGEgaHVtZWRhZCBlcyAxMDAlLCBlbCBzZW5zb3IgZGUgdGVtcGVyYXR1cmEgbm8gZnVuY2lvbmEgY29ycmVjdGFtZW50ZSB5IG5lY2VzaXRhbW9zIGFwbGljYXJsZSB1bmEgY29ycmVjY2nDs24gZGUgLTLCsCBlbiBlc2FzIHNpdHVhY2lvbmVzLiAKClBvZHLDrWFtb3MgZmlsdHJhciBsYXMgb2JzZXJ2YWNpb25lcyBxdWUgY3VtcGxlbiBjb24gcXVlIGBIdW1lZGFkX01lZGlhID09IDEwMGAgeSBsdWVnbyBtb2RpZmljYXIgbGEgdGVtcGVyYXR1cmEsIHBlcm8gZW50b25jZXMgdGVuZHLDrWFtb3MgdW5hIGJhc2UgZGUgZGF0b3MgcGFyYSBsYXMgb2JzZXJ2YWNpb25lcyBjb24gbWF5b3IgaHVtZWRhZCB5IGxhIHRlbXBlcmF0dXJhIGNvcnJlZ2lkYSB5IG90cmEgYmFzZSBkZSBkYXRvcyBzaW4gbGEgY29ycmVjY2nDs24uIE5lY2VzaXRhbW9zIHBvZGVyIG1vZGlmaWNhciAqc29sbyBhbGd1bmFzKiBvYnNlcnZhY2lvbmVzIHkgcXVlIGVsIHJlc3RvIHNlIG1hbnRlbmdhIGlndWFsLgoKUGFyYSBlc28gcG9kZW1vcyB1dGlsaXphciBsYSBmdW5jacOzbiBgaWZfZWxzZSgpYCwgcXVlIGFwbGljYSB1bmEgb3BlcmFjacOzbiAqc2kgb2N1cnJlIGFsZ28qIHkgb3RyYSBvcGVyYWNpw7NuICpzaSBubyouIEVuIGVzdGUgY2FzbyBzaSBgSHVtZWRhZF9NZWRpYSA9PSAxMDBgIGVzIHZlcmRhZGVyYSwgcmVzdGFtb3MgMiBncmFkb3MgYSBsYSBUZW1wZXJhdHVyYSwgc2kgZXMgZmFsc2Egbm8gbGEgbW9kaWZpY2Ftb3MuIFkgcG9yIHN1cHVlc3RvIHNlIGxhIGFwbGljYW1vcyBhIGxhIGNvbHVtbmEgY29uIGBtdXRhdGUoKWAKCmBgYHtyfQpiYXJpbG9jaGUgJT4lIAogIG11dGF0ZShUZW1wZXJhdHVyYV9BYnJpZ29fMTUwY20gPSBpZl9lbHNlKEh1bWVkYWRfTWVkaWEgPT0gMTAwLCAgICAgICAjIENvbmRpY2nDs24KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBUZW1wZXJhdHVyYV9BYnJpZ29fMTUwY20gLTIsIyBTaSBlcyB2ZXJkYWRlcmEKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBUZW1wZXJhdHVyYV9BYnJpZ29fMTUwY20pKSAgIyBTaSBlcyBmYWxzYQpgYGAKCjo6OnsuYWxlcnQgLmFsZXJ0LXN1Y2Nlc3N9CgpMYSBtYXlvcsOtYSBkZSBsYXMgZnVuY2lvbmVzIGRlIFIgcHVlZGVuIHRyYWJhamFyIHNvYnJlIHZlY3RvcmVzICh5IGxhcyBjb2x1bW5hcyBkZSB1biBkYXRhLmZyYW1lIHNvbiBjb21vIHZlY3RvcmVzIG9yZGVuYWRvcyEpIHkgbG8gaGFjZW4gKiplbGVtZW50byBhIGVsZW1lbnRvKiouIAoKRW4gZXN0ZSBjYXNvIGBpZl9lbHNlKClgIHJlY29ycmUgbGEgY29sdW1uYSBjb24gbGEgaW5mb3JtYWNpw7NuIGRlIGh1bWVkYWQgeSAqZWxlbWVudG8gYSBlbGVtZW50byogcmV2aXNhIHNpIGVsIHZhbG9yIGVzIGlndWFsIGEgMTAwLiBMdWVnbyBkZWNpZGUgc2kgZGViZSBtb2RpZmljYXIgbyBubyBjYWRhIGVsZW1lbnRvLCBlbiBlbCBvcmRlbiBlbiBlbCBxdWUgYXBhcmVjZW4uCjo6OgoKOjo6ey5hbGVydCAuYWxlcnQtaW5mb30KCioqRGVzYWbDrW8qKgoKQWhvcmEgZXMgdHUgdHVybm8sICJhcnJlZ2zDoSIgbGFzIHZhcmlhYmxlcyBgVGVtcGVyYXR1cmFfQWJyaWdvXzE1MGNtX01heGltYWAgeSBgVGVtcGVyYXR1cmFfQWJyaWdvXzE1MGNtX01pbmltYWAgcGFyYSBhcGxpY2FyIGxhIG1pc21hIGNvcnJlY2Npw7NuIGRlIDIgZ3JhZG9zLiAKOjo6CgojIyBEZXNhZ3J1cGFuZG8gY29uIGB1bmdyb3VwKClgCgpFbiBnZW5lcmFsLCBsYSBtYXlvcsOtYSBkZSBsYXMgZnVuY2lvbmVzIGRlIHtkcGx5cn0gImVudGllbmRlbiIgY3VhbmRvIHVuYSB0YWJsYSBlc3TDoSBhZ3J1cGFkYSB5IHJlYWxpemFuIGxhcyBvcGVyYWNpb25lcyBwYXJhIGNhZGEgZ3J1cG8uIAoKOjo6IHsuYWxlcnQgLmFsZXJ0LWluZm99CioqRGVzYWbDrW86KioKCsK/Q3XDoWwgZGUgZXN0b3MgZG9zIGPDs2RpZ29zIGFncmVnYSB1bmEgY29sdW1uYSBsbGFtYWRhICJUZW1wZXJhdHVyYV9tYXhfbWVkaWEiIGNvbiBlbCBsYSB0ZW1wZXJhdHVyYSBtw6F4aW1hIG1lZGlhIHBhcmEgY2FkYSBtZXM/IMK/UXXDqSBoYWNlIGVsIG90cm8/CgpgYGB7ciwgZXZhbCA9IEZBTFNFfQpiYXJpbG9jaGUgJT4lIAogIGdyb3VwX2J5KG1lcykgJT4lIAogIG11dGF0ZShUZW1wZXJhdHVyYV9tYXhfbWVkaWEgPSBtZWFuKFRlbXBlcmF0dXJhX0Ficmlnb18xNTBjbV9NYXhpbWEsIG5hLnJtID0gVFJVRSkpIAoKYmFyaWxvY2hlICU+JSAKICBtdXRhdGUoVGVtcGVyYXR1cmFfbWF4X21lZGlhID0gbWVhbihUZW1wZXJhdHVyYV9BYnJpZ29fMTUwY21fTWF4aW1hLCBuYS5ybSA9IFRSVUUpKSAgCmBgYAo6OjoKCkVuIG90cmFzIHBhbGFicmFzLCBsb3MgcmVzdWx0YWRvcyBkZSBgbXV0YXRlKClgLCBgZmlsdGVyKClgLCBgc3VtbWFyaXNlKClgIHkgb3RyYXMgZnVuY2lvbmVzIGNhbWJpYW4gc2Vnw7puIHNpIGxhIHRhYmxhIGVzdMOhIGFncnVwYWRhIG8gbm8uIENvbW8gYSB2ZWNlcyB1bm8gc2UgcHVlZGUgb2x2aWRhciBxdWUgcXVlZGFyb24gZ3J1cG9zLCBlcyBjb252ZW5pZW50ZSB1c2FyIGxhIGZ1bmNpw7NuIGB1bmdyb3VwKClgIHVuYSB2ZXogcXVlIGRlasOhcyBkZSB0cmFiYWphciBjb24gZ3J1cG9zOgoKYGBge3J9CmJhcmlsb2NoZSAlPiUgCiAgZ3JvdXBfYnkobWVzKSAlPiUgCiAgbXV0YXRlKFRlbXBlcmF0dXJhX21heF9tZWRpYSA9IG1lYW4oVGVtcGVyYXR1cmFfQWJyaWdvXzE1MGNtX01heGltYSwgbmEucm0gPSBUUlVFKSkgJT4lICAKICB1bmdyb3VwKCkKYGBgCgo8ZGl2IGNsYXNzPSJidG4tZ3JvdXAiIHJvbGU9Imdyb3VwIiBhcmlhLWxhYmVsPSJOYXZlZ2FjacOzbiI+CiAgPGEgaHJlZj0gIjA0LWxlY3R1cmEuaHRtbCIgY2xhc3MgPSAiYnRuIGJ0bi1wcmltYXJ5Ij5BbnRlcmlvcjwvYT4KICA8YSBocmVmPSAiMDYtZHBseXItdGlkeXItSUkuaHRtbCIgY2xhc3MgPSAiYnRuIGJ0bi1wcmltYXJ5Ij5TaWd1aWVudGU8L2E+CjwvZGl2PgoK</div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("05-dplyr.Rmd");
});
</script>

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
